<div class="profile-container">
    <h1>Mi Perfil</h1>

    @if (successMsg) {
    <app-alert variant="success">{{ successMsg }}</app-alert>
    }
    @if (errorMsg) {
    <app-alert variant="error">{{ errorMsg }}</app-alert>
    }

    <div class="profile-grid">
        <!-- Información Personal -->
        <app-card title="Información Personal">
            <form [formGroup]="profileForm" (ngSubmit)="updateProfile()">
                <div class="form-group">
                    <label>Nombre</label>
                    <input type="text" formControlName="firstName" class="form-control">
                </div>
                <div class="form-group">
                    <label>Apellido</label>
                    <input type="text" formControlName="lastName" class="form-control">
                </div>
                <div class="form-group">
                    <label>Email (No editable)</label>
                    <input type="email" formControlName="email" class="form-control disabled">
                </div>

                <div class="card-footer">
                    <app-button type="submit" [loading]="loading" [disabled]="profileForm.invalid">
                        Guardar Cambios
                    </app-button>
                </div>
            </form>
        </app-card>

        <!-- Cambio de Contraseña -->
        <app-card title="Cambiar Contraseña">
            <form [formGroup]="passwordForm" (ngSubmit)="changePassword()">
                <div class="form-group">
                    <label>Contraseña Actual</label>
                    <input type="password" formControlName="currentPassword" class="form-control">
                </div>
                <div class="form-group">
                    <label>Nueva Contraseña</label>
                    <input type="password" formControlName="newPassword" class="form-control">
                    <small>Mínimo 8 caracteres</small>
                </div>
                <div class="form-group">
                    <label>Confirmar Nueva Contraseña</label>
                    <input type="password" formControlName="confirmPassword" class="form-control">
                    @if (passwordForm.errors?.['mismatch'] && passwordForm.get('confirmPassword')?.touched) {
                    <div class="error-msg">
                        Las contraseñas no coinciden
                    </div>
                    }
                </div>

                <div class="card-footer">
                    <app-button type="submit" variant="primary" [loading]="loading" [disabled]="passwordForm.invalid">
                        Actualizar Contraseña
                    </app-button>
                </div>
            </form>
        </app-card>
    </div>
</div>