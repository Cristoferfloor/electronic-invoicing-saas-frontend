<form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="user-form">
    <div class="form-grid">
        <div class="form-group">
            <label for="firstName">Nombre *</label>
            <input id="firstName" type="text" formControlName="firstName" class="form-control" placeholder="Ej. Juan">
            @if (userForm.get('firstName')?.touched && userForm.get('firstName')?.invalid) {
            <div class="error-msg">
                Nombre es requerido
            </div>
            }
        </div>

        <div class="form-group">
            <label for="lastName">Apellido *</label>
            <input id="lastName" type="text" formControlName="lastName" class="form-control" placeholder="Ej. Perez">
            @if (userForm.get('lastName')?.touched && userForm.get('lastName')?.invalid) {
            <div class="error-msg">
                Apellido es requerido
            </div>
            }
        </div>

        <div class="form-group full-width">
            <label for="email">Correo Electrónico *</label>
            <input id="email" type="email" formControlName="email" class="form-control"
                placeholder="juan.perez@empresa.com">
            @if (userForm.get('email')?.touched && userForm.get('email')?.invalid) {
            <div class="error-msg">
                @if (userForm.get('email')?.errors?.['required']) {
                <span>Email es requerido</span>
                }
                @if (userForm.get('email')?.errors?.['email']) {
                <span>Email inválido</span>
                }
            </div>
            }
        </div>

        @if (!user) {
        <div class="form-group">
            <label for="password">Contraseña *</label>
            <input id="password" type="password" formControlName="password" class="form-control" placeholder="••••••••">
            @if (userForm.get('password')?.touched && userForm.get('password')?.invalid) {
            <div class="error-msg">
                Mínimo 8 caracteres
            </div>
            }
        </div>
        }

        <div class="form-group">
            <label for="role">Rol en la empresa *</label>
            <select id="role" formControlName="role" class="form-control">
                <option value="USER">Usuario Estándar</option>
                <option value="ADMIN">Administrador</option>
            </select>
        </div>

        @if (user) {
        <div class="form-group full-width checkbox-group">
            <label class="checkbox-container">
                <input type="checkbox" formControlName="isActive">
                <span class="checkmark"></span>
                Usuario Activo
            </label>
        </div>
        }
    </div>

    @if (error) {
    <div class="alert-error">
        {{ error }}
    </div>
    }

    <div class="form-actions">
        <app-button type="button" variant="secondary" (btnClick)="cancel.emit()" [disabled]="loading">
            Cancelar
        </app-button>
        <app-button type="submit" variant="primary" [loading]="loading" [disabled]="userForm.invalid">
            {{ user ? 'Actualizar' : 'Crear' }} Usuario
        </app-button>
    </div>
</form>